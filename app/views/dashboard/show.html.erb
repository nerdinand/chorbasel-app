<% content_for :title, t('.title') %>

<% if @info.present? %>
  <div class="<%= @info.kind %>">
    <p>
      <b><%= @info.title %></b>
    </p>
    <%= @info.description %>
  </div>
<% end %>

<% unless current_user.profile_complete? %>
  <div>
    <%= t('.profile_completeness.message') %>
    <%= link_to t('.profile_completeness.link'), edit_user_path(current_user) %>
  </div>
<% end %>

<h2><%= t('.upcoming_birthdays.title') %></h2>

<p><%= t('.upcoming_birthdays.description') %></p>
<ul>
  <% @upcoming_birthdays.each do |user, next_birthday| %>
    <li>
      <%= l next_birthday %>: <b><%= user.full_name %></b>
    </li>
  <% end %>
</ul>

<h2><%= t('.calendar.title') %></h2>

<table>
  <thead>
    <tr>
      <% @calendar_events.each do |calendar_event| %>
        <th class="<%= calendar_event.practice? ? '' : 'bg-complementary bg-opacity-30' %>">
          <%= link_to_if policy(calendar_event).show?, calendar_event.date, calendar_event %>
        </th>
      <% end %>
    </tr>
  </thead>
  
  <tbody class="border-r-2">
    <tr>
      <% @calendar_events.each do |calendar_event| %>
        <td class="text-center">
          <%= attendance_action_symbol(calendar_event) %>
        </td>
      <% end %>
    </tr>
  </tbody>
</table>

<% @upcoming_calendar_events.each do |calendar_event| %>
  <div class="my-5 p-2 border-solid border-primary border-2 rounded bg-gray <%= 'bg-complementary bg-opacity-30' unless calendar_event.practice? %>">
    <p class="font-bold">
      <% if policy(Attendance).index? %>
        <%= link_to calendar_event do %>
          <%= calendar_event.summary %>
        <% end %>
      <% else %>
        <%= calendar_event.summary %>
      <% end %>
    </p>
    <%= render calendar_event %>

    <%= attendance_action_or_status(calendar_event) %>
  </div>
<% end %>

<% if policy(:calendar_sync).create? %>
  <%= button_to t('.calendar_events.sync'), calendar_events_syncs_path, method: :post, class: 'btn btn-primary' %>
<% end %>
